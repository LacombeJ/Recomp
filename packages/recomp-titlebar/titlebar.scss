@mixin init() {
  @include master($menubar_selector: '.menubar', $menubutton_selector: '.button');
}

$default_background: transparent;
$default_hover: rgba(180, 180, 180, 0.3);
$default_color: #f8f8f8;
$default_button_width: 30px;
$default_menu_background: #202020;
$default_border_color: #555b5e;
$default_separator_size: 4px;

@mixin titlebar($backgroundColor: $default_background, $fontColor: $default_color) {
  position: relative;
  background-color: $backgroundColor;
  color: $fontColor;
  -webkit-app-region: drag;
  margin: 0;
  display: flex;
  width: 100%;
  height: 100%;
  font-size: 12px;
  user-select: none;
  z-index: 2000;
}

@mixin titleicon($backgroundColor: $default_background) {
  position: relative;
  z-index: 1000;
  background-color: $backgroundColor;
  width: 20px;
  height: 100%;
  padding: 0px 4px;
  display: flex;
  justify-content: center;
  align-items: center;
}

@mixin menubar($backgroundColor: $default_background) {
  background-color: $backgroundColor;
  height: 100%;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  flex-grow: 1;
  flex-wrap: wrap;
  overflow: hidden;
  z-index: 1000;
}

@mixin menubutton($backgroundColor: $default_background, $backgroundColorHover: $default_hover) {
  position: relative;

  background-color: $backgroundColor;
  height: 100%;
  -webkit-app-region: no-drag;
  text-align: center;
  justify-content: center;
  align-items: center;
  display: flex;

  .highlight {
    position: absolute;
    inset: 4px 2px;
    z-index: 0;
    transition: background-color 0.2s;
    border-radius: 4px;
  }

  .label {
    padding-left: 10px;
    padding-right: 10px;
    z-index: 1;
  }

  &:hover .highlight {
    background-color: $backgroundColorHover;
  }

  &.active .highlight {
    background-color: $backgroundColorHover;
  }
}

@mixin header() {
  position: relative;
  z-index: 1000;
  display: block;
  margin: auto;
  justify-content: center;
  align-items: center;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
  flex-wrap: wrap;
  overflow: hidden;
  padding-left: 8px;
  padding-right: 8px;
}

@mixin controlbar($backgroundColor: $default_background) {
  position: relative;
  z-index: 1000;
  background-color: $backgroundColor;
  height: 100%;
  display: flex;
  justify-content: flex-end;
  align-items: center;
  flex-grow: 1;
}

@mixin controlbutton($backgroundColor: $default_background,
  $backgroundColorHover: $default_hover,
  $closeButtonSelector: '.close',
  $closeButtonColorHover: rgba(red, 0.75),
  $buttonWidth: $default_button_width) {

  background-color: $backgroundColor;
  -webkit-app-region: no-drag;
  padding-left: 8px;
  padding-right: 8px;
  width: $buttonWidth;
  height: 100%;
  display: flex;
  flex-flow: row wrap;
  text-align: center;
  justify-content: center;
  align-items: center;
  transition: background-color 0.2s;

  &:hover {
    background-color: $backgroundColorHover;
  }

  &#{$closeButtonSelector}:hover {
    background-color: $closeButtonColorHover;
  }
}

@mixin dropbar($separatorSelector: '.separator',
  $backgroundColor: $default_menu_backgroun,
  $borderColor: $default_border_color,
  $separatorColor: $default_border_color,
  $separatorWidth: $default_separator_size) {

  background-color: $backgroundColor;
  position: fixed;
  box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.4);
  min-width: 200px;
  z-index: 1000;
  padding: 8px 0 8px 0;
  border: 1px solid $borderColor;

  #{$separatorSelector} {
    min-height: $separatorWidth;
    border-bottom: 1px solid $separatorColor;
    margin-bottom: $separatorWidth;
    margin-left: 30px;
    margin-right: 6px;
  }
}

@mixin dropbutton($labelSelector: '.label',
  $acceleratorSelector: '.accelerator',
  $backgroundColor: $default_background,
  $backgroundColorHover: $default_hover) {

  background-color: $backgroundColor;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  flex-grow: 1;
  flex-wrap: wrap;
  overflow: hidden;
  height: 22px;

  &:hover {
    background-color: $backgroundColorHover;
  }

  #{$labelSelector} {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 2px 30px 2px 30px;
  }

  #{$acceleratorSelector  } {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    flex-grow: 1;
    padding: 2px 30px 2px 30px;
  }
}

@mixin master($titlebar_selector: '.recomp-titlebar',
  $titleicon_selector: '.titleicon',
  $menubar_selector: '.menubar',
  $menubutton_selector: '.button',
  $dropbar_offset: '.menu-offset',
  $dropbar_selector: '.menu',
  $dropbar_separator_selector: '.separator',
  $dropbutton_selector: '.item',
  $dropbutton_label_selector: '.label',
  $dropbutton_accelerator_selector: '.accelerator',
  $titleheader_selector: '.header',
  $controlbar_selector: '.controlbar',
  $controlbutton_selector: '.button',
  $close_selector: '.close',
  $fontColor: $default_color,
  $backgroundColor: $default_background,
  $hoverColor: $default_hover,
  $dropdownColor: $default_menu_background,
  $borderColor: $default_border_color,
  $controlButtonWidth: $default_button_width) {

  #{$titlebar_selector} {
    @include titlebar($backgroundColor: $backgroundColor,
      $fontColor: $fontColor,
    );

    >#{$titleicon_selector} {
      @include titleicon();
    }

    >#{$menubar_selector} {
      @include menubar();

      >#{$menubutton_selector} {
        @include menubutton($backgroundColorHover: $hoverColor,
        );
      }
    }

    #{$dropbar_offset} {
      position: fixed;
    }

    >#{$dropbar_selector} {
      @include dropbar($separatorSelector: $dropbar_separator_selector,
        $backgroundColor: $dropdownColor,
        $borderColor: $borderColor,
        $separatorColor: $borderColor,
      );

      >#{$dropbutton_selector} {
        @include dropbutton($labelSelector: $dropbutton_label_selector,
          $acceleratorSelector: $dropbutton_accelerator_selector,
          $backgroundColorHover: $hoverColor,
        );
      }
    }

    >#{$titleheader_selector} {
      @include header();
    }

    >#{$controlbar_selector} {
      @include controlbar();

      >#{$controlbutton_selector} {
        @include controlbutton($backgroundColorHover: $hoverColor,
          $closeButtonSelector: $close_selector,
          $buttonWidth: $controlButtonWidth,
        );
      }
    }
  }
}